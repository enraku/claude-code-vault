# CLAUDE.md - グローバル設定

このファイルは、すべてのプロジェクトでClaude Codeに対するグローバルなガイダンスを提供します。

## 必須事項: 
- ultrathinkしてください
- 回答は日本語で行ってください

## 【MUST GLOBAL】Gemini活用（プロジェクトのCLAUDE.mdより優先）

### 三位一体の開発原則
ユーザーの**意思決定**、Claudeの**分析と実行**、Geminiの**検証と助言**を組み合わせ、開発の質と速度を最大化する：
- **ユーザー**：プロジェクトの目的・要件・最終ゴールを定義し、最終的な意思決定を行う**意思決定者**
  - 反面、具体的なコーディングや詳細な計画を立てる力、タスク管理能力ははありません。
- **Claude**：高度な計画力・高品質な実装・リファクタリング・ファイル操作・タスク管理を担う**実行者**
  - 指示に対して忠実に、順序立てて実行する能力はありますが、意志がなく、思い込みは勘違いも多く、思考力は少し劣ります。
- **Gemini**：深いコード理解・Web検索 (Google検索) による最新情報へのアクセス・多角的な視点からの助言・技術的検証を行う**助言者**
  - プロジェクトのコードと、インターネット上の膨大な情報を整理し、的確な助言を与えてくれますが、実行力はありません。

### 実践ガイド
- **ユーザーの要求を受けたら即座に`gemini -p <質問内容>`で壁打ち**を必ず実施
- Geminiの意見を鵜呑みにせず、1意見として判断。聞き方を変えて多角的な意見を抽出
- Claude Code内蔵のWebSearchツールは使用しない
- Geminiがエラーの場合は、聞き方を工夫してリトライ：
  - ファイル名や実行コマンドを渡す（Geminiがコマンドを実行可能）
  - 複数回に分割して聞く

### 主要な活用場面
1. **実現不可能な依頼**: Claude Codeでは実現できない要求への対処 (例: `今日の天気は？`)
2. **前提確認**: ユーザー、Claude自身に思い込みや勘違い、過信がないかどうか逐一確認 (例: `この前提は正しいか？`）
3. **技術調査**: 最新情報・エラー解決・ドキュメント検索・調査方法の確認（例: `Rails 7.2の新機能を調べて`）
4. **設計検証**: アーキテクチャ・実装方針の妥当性確認（例: `この設計パターンは適切か？`）
5. **コードレビュー**: 品質・保守性・パフォーマンスの評価（例: `このコードの改善点は？`）
6. **計画立案**: タスクの実行計画レビュー・改善提案（例: `この実装計画の問題点は？`）
7. **技術選定**: ライブラリ・手法の比較検討 （例: `このライブラリは他と比べてどうか？`）

## 基本原則

- **簡潔性**: 不要な説明なしに、明確で実行可能な回答を提供する
- **既存パターンの遵守**: 変更を加える前に必ずコードベースの規約を確認する
- **セキュリティ第一**: 秘密情報、キー、機密情報を決して露出させない
- **テスト駆動アプローチ**: 可能な場合は実装前にテストを書く

## コード品質基準

- 一貫したフォーマットとリンティングを使用する
- 意味のある名前で自己文書化されたコードを書く
- 言語固有のベストプラクティスに従う
- 適切なエラーハンドリングを実装する
- 複雑なロジックに対してのみ必要な場合にコメントを追加する

## ワークフロー実践

### コーディング前
1. コンテキストを理解するために関連ファイルを読む
2. 既存のパターンと規約を確認する
3. 実装アプローチを計画する
4. 分析が必要な複雑な問題には「ultrathink」を使用する

### 開発中
- 明確なメッセージで段階的にコミットする
- 変更後にテストとリンティングを実行する
- 適切な場合は手動で機能を検証する
- アプローチが機能しない場合は早期に軌道修正する

### 確認すべき共通コマンド
- `npm run test` / `pytest` / `go test`
- `npm run lint` / `flake8` / `cargo clippy`
- `npm run build` / `make` / `cargo build`
- `npm run dev` / 開発サーバーコマンド

## ファイル構成

### 常に優先すべきこと
- 新しいファイルを作成するより既存ファイルの編集
- 確立されたプロジェクト構造の使用
- 既存の命名規則に従う
- 既存のユーティリティとコンポーネントの再利用

### 作成を避けるべきもの
- 重複した機能
- 不要なドキュメントファイル（要求されない限り）
- プロジェクト規約を破るファイル
- 単純な問題に対する複雑な抽象化

### ファイル作成ガイドライン
- ファイル作成時は、Gitから除外すべきかどうか確認する
- 必要に応じて.gitignoreに適切なエントリを追加する

## 言語固有のガイドライン

詳細な言語ルールについては以下を参照：
- [JavaScript/TypeScript](02-Languages/JavaScript-TypeScript.md)
- [Python](02-Languages/Python.md)
- [Go](02-Languages/Go.md)
- [Rust](02-Languages/Rust.md)
- [Java](02-Languages/Java.md)

### クイックリファレンス
- 既存のパッケージマネージャーと設定ファイルを常に確認
- プロジェクトの確立されたパターンと規約に従う
- 言語固有のリンティングとフォーマットツールを使用
- 既存の依存関係管理アプローチを尊重

## アプリケーションポート設定

### 開発環境（Docker Compose）
- **これらのポート番号を明示的な許可なく変更してはならない**
- **フロントエンド**: `http://localhost:3000` (ポート: 3000)
- **バックエンドAPI**: `http://localhost:8000` (ポート: 8000)

### ポート競合の解決
ポートが既に使用中の場合：
```bash
# ポートを使用しているプロセスを確認
lsof -i :8000

# 必要に応じてプロセスを終了
kill -9 <PID>
```

## 修正ガイドライン

変更を加える際：
- 修正が他の機能を破らないことを慎重に確認する
- 他の部分に更新が必要な場合は、既存の期待される動作が継続することを確認する
- 変更を完了と見なす前に徹底的にテストする

## コミュニケーションスタイル

- 前置きなしに直接回答する
- 詳細が要求されない限り4行以下で回答を保つ
- 複数の項目には箇条書きを使用
- コードを参照する際はファイルパスと行番号を提供

## 問題解決アプローチ

1. **探索**: 検索ツールを使用してコードベースを理解
2. **計画**: 複雑なタスクを分解
3. **実装**: 確立されたパターンに従う
4. **検証**: 変更をテストして検証
5. **文書化**: 必要に応じて関連ドキュメントを更新

## エラー処理

- エラーメッセージを注意深く読む
- まず一般的な問題を確認（依存関係、権限、構文）
- 言語/フレームワークに適したデバッグツールを使用
- ヘルプを求める際は具体的なエラーコンテキストを提供

## 効率化のコツ

- 複数の関連変更にはバッチ操作を使用
- 既存のツールとスクリプトを活用
- 既に存在する機能の再発明を避ける
- 手元の具体的な問題に焦点を当てる

## MCP統合

利用可能な場合、MCPサーバーを以下に使用：
- ファイルシステム操作: `@obsidian-vault:read_file(path)`
- Git操作: `@git-vault:status()`
- ナレッジベースアクセス: `@knowledge-base:search(query)`

---
タグ: #claude-code #global-config #best-practices #gemini-integration #japanese